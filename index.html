<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Python Decoder / Encoder Tool</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;600;700&family=Syne:wght@400;600;800&display=swap');

  :root {
    --bg: #0d0f14;
    --surface: #141720;
    --surface2: #1b1f2e;
    --border: #252a3a;
    --accent: #00f5a0;
    --accent2: #00c9ff;
    --accent3: #ff6b6b;
    --accent4: #ffd93d;
    --accent5: #c77dff;
    --text: #e8eaf6;
    --text-dim: #6b7280;
    --glow: rgba(0,245,160,0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Animated background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse 80% 40% at 10% 20%, rgba(0,245,160,0.04) 0%, transparent 60%),
      radial-gradient(ellipse 60% 60% at 90% 80%, rgba(0,201,255,0.04) 0%, transparent 60%),
      radial-gradient(ellipse 40% 40% at 50% 50%, rgba(199,125,255,0.03) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 1100px;
    margin: 0 auto;
    padding: 24px 20px;
  }

  /* Header */
  .header {
    text-align: center;
    padding: 32px 0 28px;
    animation: fadeDown 0.6s ease;
  }

  .header-badge {
    display: inline-block;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-family: 'Syne', sans-serif;
    font-size: 11px;
    font-weight: 800;
    letter-spacing: 4px;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .header h1 {
    font-family: 'Syne', sans-serif;
    font-size: clamp(28px, 5vw, 44px);
    font-weight: 800;
    color: var(--text);
    letter-spacing: -1px;
    line-height: 1.1;
  }

  .header h1 span {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .header p {
    margin-top: 10px;
    color: var(--text-dim);
    font-size: 13px;
    letter-spacing: 0.5px;
  }

  /* Category tabs */
  .tabs-wrapper {
    margin-bottom: 20px;
    overflow-x: auto;
    padding-bottom: 4px;
    scrollbar-width: none;
  }
  .tabs-wrapper::-webkit-scrollbar { display: none; }

  .tabs {
    display: flex;
    gap: 6px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 6px;
    width: fit-content;
    min-width: 100%;
  }

  .tab-btn {
    flex: 1;
    min-width: 90px;
    padding: 9px 14px;
    background: transparent;
    border: none;
    border-radius: 8px;
    color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
    letter-spacing: 0.5px;
  }

  .tab-btn:hover {
    color: var(--text);
    background: var(--surface2);
  }

  .tab-btn.active {
    background: var(--surface2);
    color: var(--accent);
    border: 1px solid rgba(0,245,160,0.25);
    box-shadow: 0 0 12px rgba(0,245,160,0.08);
  }

  /* Method grid */
  .method-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 8px;
    margin-bottom: 20px;
  }

  .method-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 10px 12px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-dim);
  }

  .method-card:hover {
    border-color: rgba(0,245,160,0.3);
    color: var(--text);
    background: var(--surface2);
    transform: translateY(-1px);
  }

  .method-card.active {
    border-color: var(--accent);
    color: var(--accent);
    background: rgba(0,245,160,0.06);
    box-shadow: 0 0 16px rgba(0,245,160,0.1);
  }

  .method-card .dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  /* Main panel */
  .main-panel {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    animation: fadeUp 0.5s ease;
  }

  .panel-header {
    padding: 16px 20px;
    background: var(--surface2);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 10px;
  }

  .panel-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
  }

  .panel-tag {
    font-size: 10px;
    font-family: 'JetBrains Mono', monospace;
    padding: 3px 9px;
    border-radius: 20px;
    font-weight: 600;
    letter-spacing: 1px;
  }

  .mode-switch {
    display: flex;
    background: var(--bg);
    border-radius: 8px;
    padding: 4px;
    gap: 4px;
    border: 1px solid var(--border);
  }

  .mode-btn {
    padding: 6px 16px;
    border: none;
    border-radius: 6px;
    background: transparent;
    color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.5px;
  }

  .mode-btn.active {
    background: var(--surface2);
    color: var(--accent);
  }

  /* IO area */
  .io-grid {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 0;
    padding: 20px;
    gap: 12px;
    align-items: center;
  }

  @media (max-width: 640px) {
    .io-grid { grid-template-columns: 1fr; }
    .arrow-col { transform: rotate(90deg); }
  }

  .io-box {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .io-label {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-dim);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .copy-btn {
    background: none;
    border: 1px solid var(--border);
    border-radius: 4px;
    color: var(--text-dim);
    font-size: 10px;
    padding: 2px 8px;
    cursor: pointer;
    font-family: 'JetBrains Mono', monospace;
    transition: all 0.15s;
  }

  .copy-btn:hover { border-color: var(--accent); color: var(--accent); }
  .copy-btn.copied { border-color: var(--accent); color: var(--accent); }

  textarea {
    width: 100%;
    min-height: 160px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    padding: 14px;
    resize: vertical;
    outline: none;
    transition: border-color 0.2s;
    line-height: 1.6;
  }

  textarea:focus { border-color: rgba(0,245,160,0.4); }
  textarea::placeholder { color: var(--text-dim); }

  .output-area {
    min-height: 160px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    padding: 14px;
    white-space: pre-wrap;
    word-break: break-all;
    line-height: 1.6;
    position: relative;
    overflow: auto;
  }

  .output-area.error { color: var(--accent3); border-color: rgba(255,107,107,0.3); }
  .output-area.success { border-color: rgba(0,245,160,0.2); }
  .output-placeholder { color: var(--text-dim); font-style: italic; }

  .arrow-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .execute-btn {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #0d0f14;
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 20px rgba(0,245,160,0.2);
    font-weight: 700;
  }

  .execute-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 0 30px rgba(0,245,160,0.4);
  }

  .execute-btn:active { transform: scale(0.95); }

  /* Extra options */
  .extra-opts {
    padding: 0 20px 16px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    align-items: center;
  }

  .opt-select {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    padding: 5px 10px;
    outline: none;
    cursor: pointer;
  }

  .opt-select:focus { border-color: var(--accent); }

  .opt-label {
    font-size: 11px;
    color: var(--text-dim);
    margin-right: 4px;
  }

  /* Info section */
  .info-bar {
    margin: 0 20px 20px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 16px;
    font-size: 12px;
    color: var(--text-dim);
    line-height: 1.7;
  }

  .info-bar strong {
    color: var(--accent);
    font-weight: 600;
  }

  /* Quick actions */
  .quick-bar {
    padding: 0 20px 20px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .quick-btn {
    padding: 7px 16px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 20px;
    color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .quick-btn:hover { border-color: var(--accent2); color: var(--accent2); }

  /* Stats */
  .stats {
    padding: 12px 20px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }

  .stat { font-size: 11px; color: var(--text-dim); }
  .stat span { color: var(--text); font-weight: 600; }

  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Python code display */
  .code-snippet {
    margin: 0 20px 20px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    overflow: hidden;
  }

  .code-header {
    background: var(--surface2);
    padding: 8px 14px;
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 1px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .code-body {
    padding: 14px;
    font-size: 12px;
    line-height: 1.7;
    overflow-x: auto;
  }

  .kw { color: #c77dff; }
  .fn { color: #00f5a0; }
  .st { color: #ffd93d; }
  .cm { color: #4b5563; }
  .num { color: #00c9ff; }
  .im { color: #ff9f43; }

  .hidden { display: none !important; }
</style>
</head>
<body>
<div class="container">
  <header class="header">
    <div class="header-badge">Python Encode / Decode</div>
    <h1>C√¥ng C·ª• <span>M√£ H√≥a & Gi·∫£i M√£</span></h1>
    <p>H·ªó tr·ª£ t·∫•t c·∫£ c√°c ph∆∞∆°ng ph√°p encode/decode ph·ªï bi·∫øn trong Python</p>
  </header>

  <!-- Category Tabs -->
  <div class="tabs-wrapper">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchCategory('text')">üìù Text / String</button>
      <button class="tab-btn" onclick="switchCategory('hash')">üîê Hash</button>
      <button class="tab-btn" onclick="switchCategory('url')">üåê URL</button>
      <button class="tab-btn" onclick="switchCategory('binary')">üî¢ Binary / Hex</button>
      <button class="tab-btn" onclick="switchCategory('cipher')">üîí Cipher</button>
      <button class="tab-btn" onclick="switchCategory('compress')">üì¶ Data Format</button>
    </div>
  </div>

  <!-- Method cards -->
  <div class="method-grid" id="methodGrid"></div>

  <!-- Main Panel -->
  <div class="main-panel">
    <div class="panel-header">
      <div class="panel-title">
        <span id="currentMethodName">Base64</span>
        <span class="panel-tag" id="panelTag" style="background:rgba(0,245,160,0.1);color:var(--accent);border:1px solid rgba(0,245,160,0.3)">ENCODE</span>
      </div>
      <div class="mode-switch">
        <button class="mode-btn active" id="encBtn" onclick="setMode('encode')">ENCODE</button>
        <button class="mode-btn" id="decBtn" onclick="setMode('decode')">DECODE</button>
      </div>
    </div>

    <!-- Extra options -->
    <div class="extra-opts" id="extraOpts"></div>

    <!-- IO Grid -->
    <div class="io-grid">
      <div class="io-box">
        <div class="io-label">
          INPUT
          <button class="quick-btn" onclick="clearInput()" style="padding:2px 8px;border-radius:4px;font-size:10px">x√≥a</button>
        </div>
        <textarea id="inputText" placeholder="Nh·∫≠p vƒÉn b·∫£n c·∫ßn x·ª≠ l√Ω..."></textarea>
      </div>
      <div class="arrow-col">
        <button class="execute-btn" onclick="execute()" title="Th·ª±c thi">‚ñ∂</button>
      </div>
      <div class="io-box">
        <div class="io-label">
          OUTPUT
          <button class="copy-btn" id="copyBtn" onclick="copyOutput()">copy</button>
        </div>
        <div class="output-area" id="outputArea">
          <span class="output-placeholder">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</span>
        </div>
      </div>
    </div>

    <!-- Quick actions -->
    <div class="quick-bar">
      <button class="quick-btn" onclick="swapIO()">‚Üï Ho√°n ƒë·ªïi Input/Output</button>
      <button class="quick-btn" onclick="autoDetect()">üîç T·ª± ƒë·ªông nh·∫≠n d·∫°ng</button>
      <button class="quick-btn" onclick="loadSample()">üìÑ T·∫£i m·∫´u</button>
    </div>

    <!-- Info -->
    <div class="info-bar" id="infoBar">Ch·ªçn ph∆∞∆°ng ph√°p ƒë·ªÉ xem th√¥ng tin chi ti·∫øt.</div>

    <!-- Python Code -->
    <div class="code-snippet">
      <div class="code-header">
        <span>PYTHON CODE</span>
        <button class="copy-btn" onclick="copyCode()">copy code</button>
      </div>
      <div class="code-body" id="codeBody">
        <span class="cm"># Python code s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</span>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats">
      <div class="stat">ƒê·∫ßu v√†o: <span id="statIn">0</span> k√Ω t·ª±</div>
      <div class="stat">ƒê·∫ßu ra: <span id="statOut">0</span> k√Ω t·ª±</div>
      <div class="stat">T·ªâ l·ªá: <span id="statRatio">-</span></div>
      <div class="stat">Ph∆∞∆°ng ph√°p: <span id="statMethod">-</span></div>
    </div>
  </div>
</div>

<script>
const categories = {
  text: {
    label: 'Text / String', color: '--accent',
    methods: [
      { id: 'base64', name: 'Base64', dot: '#00f5a0' },
      { id: 'base32', name: 'Base32', dot: '#00f5a0' },
      { id: 'base16', name: 'Base16 (Hex)', dot: '#00f5a0' },
      { id: 'base85', name: 'Base85', dot: '#00f5a0' },
      { id: 'rot13', name: 'ROT13', dot: '#00c9ff' },
      { id: 'unicode', name: 'Unicode Escape', dot: '#c77dff' },
      { id: 'html', name: 'HTML Entities', dot: '#ffd93d' },
      { id: 'ascii', name: 'ASCII Codes', dot: '#ff6b6b' },
    ]
  },
  hash: {
    label: 'Hash', color: '--accent5',
    methods: [
      { id: 'md5', name: 'MD5', dot: '#c77dff' },
      { id: 'sha1', name: 'SHA-1', dot: '#c77dff' },
      { id: 'sha256', name: 'SHA-256', dot: '#c77dff' },
      { id: 'sha512', name: 'SHA-512', dot: '#c77dff' },
      { id: 'sha3_256', name: 'SHA3-256', dot: '#c77dff' },
    ]
  },
  url: {
    label: 'URL', color: '--accent2',
    methods: [
      { id: 'url', name: 'URL Encode', dot: '#00c9ff' },
      { id: 'url_full', name: 'URL Full Encode', dot: '#00c9ff' },
      { id: 'punycode', name: 'Punycode', dot: '#00c9ff' },
    ]
  },
  binary: {
    label: 'Binary / Hex', color: '--accent3',
    methods: [
      { id: 'binary', name: 'Binary', dot: '#ff6b6b' },
      { id: 'octal', name: 'Octal', dot: '#ff6b6b' },
      { id: 'hex_str', name: 'Hex String', dot: '#ff6b6b' },
      { id: 'xxencode', name: 'XX Encode', dot: '#ff9f43' },
      { id: 'morse', name: 'Morse Code', dot: '#ffd93d' },
    ]
  },
  cipher: {
    label: 'Cipher', color: '--accent4',
    methods: [
      { id: 'caesar', name: 'Caesar Cipher', dot: '#ffd93d' },
      { id: 'vigenere', name: 'Vigen√®re', dot: '#ffd93d' },
      { id: 'atbash', name: 'Atbash', dot: '#ffd93d' },
      { id: 'xor', name: 'XOR Cipher', dot: '#ff9f43' },
    ]
  },
  compress: {
    label: 'Data Format', color: '--accent',
    methods: [
      { id: 'json_format', name: 'JSON Format', dot: '#00f5a0' },
      { id: 'json_min', name: 'JSON Minify', dot: '#00f5a0' },
      { id: 'zlib_b64', name: 'zlib+Base64', dot: '#00c9ff' },
      { id: 'gzip_b64', name: 'gzip+Base64', dot: '#00c9ff' },
    ]
  }
};

const methodInfo = {
  base64: {
    info: '<strong>Base64</strong>: M√£ h√≥a d·ªØ li·ªáu nh·ªã ph√¢n th√†nh ASCII. S·ª≠ d·ª•ng r·ªông r√£i trong email, JWT, data URI. TƒÉng k√≠ch th∆∞·ªõc ~33%.',
    code: (mode) => mode === 'encode' ? 
`<span class="im">import</span> base64

<span class="cm"># M√£ h√≥a Base64</span>
text = <span class="st">"Hello, World!"</span>
encoded = base64.b64encode(text.encode(<span class="st">'utf-8'</span>))
result = encoded.decode(<span class="st">'utf-8'</span>)
<span class="fn">print</span>(result)  <span class="cm"># SGVsbG8sIFdvcmxkIQ==</span>` :
`<span class="im">import</span> base64

<span class="cm"># Gi·∫£i m√£ Base64</span>
encoded = <span class="st">"SGVsbG8sIFdvcmxkIQ=="</span>
decoded = base64.b64decode(encoded)
result = decoded.decode(<span class="st">'utf-8'</span>)
<span class="fn">print</span>(result)  <span class="cm"># Hello, World!</span>`,
    sample: { encode: 'Hello, World! Xin ch√†o Vi·ªát Nam!', decode: 'SGVsbG8sIFdvcmxkISBYaW4gY2jDoG8gVmnhu4d0IE5hbSE=' }
  },
  base32: {
    info: '<strong>Base32</strong>: T∆∞∆°ng t·ª± Base64 nh∆∞ng d√πng 32 k√Ω t·ª±. D√πng trong TOTP (Google Auth), t√™n file kh√¥ng ph√¢n bi·ªát hoa th∆∞·ªùng.',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> base64

text = <span class="st">"Hello, World!"</span>
encoded = base64.b32encode(text.encode(<span class="st">'utf-8'</span>))
<span class="fn">print</span>(encoded.decode())  <span class="cm"># JBSWY3DPEBLW64TMMQ======</span>` :
`<span class="im">import</span> base64

encoded = <span class="st">"JBSWY3DPEBLW64TMMQ======"</span>
decoded = base64.b32decode(encoded)
<span class="fn">print</span>(decoded.decode(<span class="st">'utf-8'</span>))`,
    sample: { encode: 'Hello', decode: 'JBSWY3DPEB3W64TMMQ======' }
  },
  base16: {
    info: '<strong>Base16 / Hex</strong>: M·ªói byte ƒë∆∞·ª£c bi·ªÉu di·ªÖn b·ªüi 2 ch·ªØ s·ªë hex. D√πng trong l·∫≠p tr√¨nh h·ªá th·ªëng, m√£ m√†u CSS.',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> base64

text = <span class="st">"Hello"</span>
encoded = base64.b16encode(text.encode(<span class="st">'utf-8'</span>))
<span class="fn">print</span>(encoded.decode())  <span class="cm"># 48656C6C6F</span>

<span class="cm"># Ho·∫∑c d√πng hex()</span>
result = text.encode().hex()
<span class="fn">print</span>(result)  <span class="cm"># 48656c6c6f</span>` :
`<span class="im">import</span> base64

encoded = <span class="st">"48656C6C6F"</span>
decoded = base64.b16decode(encoded)
<span class="fn">print</span>(decoded.decode())  <span class="cm"># Hello</span>`,
    sample: { encode: 'Hello', decode: '48656C6C6F' }
  },
  base85: {
    info: '<strong>Base85</strong>: Hi·ªáu qu·∫£ h∆°n Base64, tƒÉng k√≠ch th∆∞·ªõc ch·ªâ ~25%. D√πng trong Git, PDF.',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> base64

text = <span class="st">"Hello, World!"</span>
encoded = base64.b85encode(text.encode())
<span class="fn">print</span>(encoded.decode())` :
`<span class="im">import</span> base64

encoded = <span class="st">"NM&qnZ!92pZz&bWDd@0Wn>^"</span>
decoded = base64.b85decode(encoded)
<span class="fn">print</span>(decoded.decode())`,
    sample: { encode: 'Hello, World!', decode: 'NM&qnZ!92pZz&bWDd@0Wn>^' }
  },
  rot13: {
    info: '<strong>ROT13</strong>: Thay th·∫ø m·ªói ch·ªØ c√°i b·∫±ng ch·ªØ c√°i c√°ch n√≥ 13 v·ªã tr√≠. Encode = Decode (symmetric).',
    code: (mode) =>
`<span class="im">import</span> codecs

text = <span class="st">"Hello, World!"</span>
result = codecs.encode(text, <span class="st">'rot_13'</span>)
<span class="fn">print</span>(result)  <span class="cm"># Uryyb, Jbeyq!</span>

<span class="cm"># ROT13 l√† ƒë·ªëi x·ª©ng (decode = encode)</span>
decoded = codecs.encode(result, <span class="st">'rot_13'</span>)
<span class="fn">print</span>(decoded)  <span class="cm"># Hello, World!</span>`,
    sample: { encode: 'Hello, World!', decode: 'Uryyb, Jbeyq!' }
  },
  unicode: {
    info: '<strong>Unicode Escape</strong>: Bi·ªÉu di·ªÖn k√Ω t·ª± Unicode d∆∞·ªõi d·∫°ng \\uXXXX. H·ªØu √≠ch khi l√†m vi·ªác v·ªõi JSON v√† c√°c ng√¥n ng·ªØ kh√°c nhau.',
    code: (mode) => mode === 'encode' ?
`text = <span class="st">"Xin ch√†o Vi·ªát Nam!"</span>
<span class="cm"># Unicode escape</span>
encoded = text.encode(<span class="st">'unicode_escape'</span>).decode(<span class="st">'ascii'</span>)
<span class="fn">print</span>(encoded)

<span class="cm"># Ho·∫∑c th·ªß c√¥ng</span>
result = <span class="st">""</span>.join(<span class="fn">f</span><span class="st">r"\\u{ord(c):04x}"</span> <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(result)` :
`<span class="cm"># Gi·∫£i m√£ unicode escape</span>
encoded = <span class="st">"\\u0058\\u0069\\u006e"</span>
decoded = encoded.encode(<span class="st">'ascii'</span>).decode(<span class="st">'unicode_escape'</span>)
<span class="fn">print</span>(decoded)`,
    sample: { encode: 'Xin ch√†o!', decode: '\\u0058\\u0069\\u006e \\u0063h\\u00e0o!' }
  },
  html: {
    info: '<strong>HTML Entities</strong>: Chuy·ªÉn ƒë·ªïi k√Ω t·ª± ƒë·∫∑c bi·ªát HTML nh∆∞ <, >, &, " th√†nh entity. Quan tr·ªçng ƒë·ªÉ tr√°nh XSS.',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> html

text = <span class="st">'<div class="test">Hello & World!</div>'</span>
encoded = html.escape(text)
<span class="fn">print</span>(encoded)
<span class="cm"># &lt;div class=&quot;test&quot;&gt;Hello &amp; World!&lt;/div&gt;</span>` :
`<span class="im">import</span> html

encoded = <span class="st">"&lt;div&gt;Hello &amp; World!&lt;/div&gt;"</span>
decoded = html.unescape(encoded)
<span class="fn">print</span>(decoded)  <span class="cm"># <div>Hello & World!</div></span>`,
    sample: { encode: '<div class="test">Hello & World!</div>', decode: '&lt;div class=&quot;test&quot;&gt;Hello &amp; World!&lt;/div&gt;' }
  },
  ascii: {
    info: '<strong>ASCII Codes</strong>: Chuy·ªÉn ƒë·ªïi k√Ω t·ª± th√†nh m√£ s·ªë ASCII (0-127) v√† ng∆∞·ª£c l·∫°i. H·ªØu √≠ch khi debug encoding issues.',
    code: (mode) => mode === 'encode' ?
`text = <span class="st">"Hello"</span>
<span class="cm"># Chuy·ªÉn th√†nh m√£ ASCII</span>
codes = [<span class="fn">ord</span>(c) <span class="kw">for</span> c <span class="kw">in</span> text]
<span class="fn">print</span>(codes)  <span class="cm"># [72, 101, 108, 108, 111]</span>

<span class="cm"># Chu·ªói s·ªë c√°ch nhau b·ªüi kho·∫£ng tr·∫Øng</span>
result = <span class="st">" "</span>.join(<span class="fn">str</span>(<span class="fn">ord</span>(c)) <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(result)  <span class="cm"># 72 101 108 108 111</span>` :
`<span class="cm"># Chuy·ªÉn m√£ ASCII v·ªÅ k√Ω t·ª±</span>
codes = [<span class="num">72</span>, <span class="num">101</span>, <span class="num">108</span>, <span class="num">108</span>, <span class="num">111</span>]
text = <span class="st">""</span>.join(<span class="fn">chr</span>(c) <span class="kw">for</span> c <span class="kw">in</span> codes)
<span class="fn">print</span>(text)  <span class="cm"># Hello</span>`,
    sample: { encode: 'Hello', decode: '72 101 108 108 111' }
  },
  md5: {
    info: '<strong>MD5</strong>: Hash 128-bit. KH√îNG d√πng cho b·∫£o m·∫≠t (ƒë√£ b·ªã ph√° v·ª°). D√πng ƒë·ªÉ ki·ªÉm tra t√≠nh to√†n v·∫πn file.',
    code: () =>
`<span class="im">import</span> hashlib

text = <span class="st">"Hello, World!"</span>
hash_obj = hashlib.md5(text.encode(<span class="st">'utf-8'</span>))
result = hash_obj.hexdigest()
<span class="fn">print</span>(result)  <span class="cm"># 65a8e27d8879283831b664bd8b7f0ad4</span>

<span class="cm"># Ki·ªÉm tra hash c·ªßa file</span>
<span class="kw">with</span> <span class="fn">open</span>(<span class="st">'file.txt'</span>, <span class="st">'rb'</span>) <span class="kw">as</span> f:
    md5 = hashlib.md5(f.read()).hexdigest()`,
    sample: { encode: 'Hello, World!', decode: '' }
  },
  sha1: {
    info: '<strong>SHA-1</strong>: Hash 160-bit. ƒê√£ b·ªã ph√° v·ª° v·ªõi collision attacks. Tr√°nh d√πng cho b·∫£o m·∫≠t.',
    code: () =>
`<span class="im">import</span> hashlib

text = <span class="st">"Hello, World!"</span>
result = hashlib.sha1(text.encode()).hexdigest()
<span class="fn">print</span>(result)
<span class="cm"># 0a0a9f2a6772942557ab5355d76af442f8f65e01</span>`,
    sample: { encode: 'Hello, World!', decode: '' }
  },
  sha256: {
    info: '<strong>SHA-256</strong>: Hash 256-bit an to√†n. Ti√™u chu·∫©n v√†ng cho b·∫£o m·∫≠t, d√πng trong Bitcoin, JWT, SSL.',
    code: () =>
`<span class="im">import</span> hashlib

text = <span class="st">"Hello, World!"</span>
result = hashlib.sha256(text.encode(<span class="st">'utf-8'</span>)).hexdigest()
<span class="fn">print</span>(result)

<span class="cm"># HMAC v·ªõi SHA-256</span>
<span class="im">import</span> hmac
key = <span class="st">b'secret_key'</span>
mac = hmac.new(key, text.encode(), hashlib.sha256).hexdigest()`,
    sample: { encode: 'Hello, World!', decode: '' }
  },
  sha512: {
    info: '<strong>SHA-512</strong>: Hash 512-bit, an to√†n nh·∫•t trong h·ªç SHA-2. D√πng khi c·∫ßn b·∫£o m·∫≠t t·ªëi ƒëa.',
    code: () =>
`<span class="im">import</span> hashlib

text = <span class="st">"Hello, World!"</span>
result = hashlib.sha512(text.encode()).hexdigest()
<span class="fn">print</span>(result)  <span class="cm"># 512-bit = 128 hex chars</span>`,
    sample: { encode: 'Hello, World!', decode: '' }
  },
  sha3_256: {
    info: '<strong>SHA3-256</strong>: Th·∫ø h·ªá m·ªõi c·ªßa SHA. D·ª±a tr√™n thu·∫≠t to√°n Keccak, kh√°ng l∆∞·ª£ng t·ª≠ t·ªët h∆°n SHA-2.',
    code: () =>
`<span class="im">import</span> hashlib

text = <span class="st">"Hello, World!"</span>
result = hashlib.sha3_256(text.encode()).hexdigest()
<span class="fn">print</span>(result)`,
    sample: { encode: 'Hello, World!', decode: '' }
  },
  url: {
    info: '<strong>URL Encode</strong>: M√£ h√≥a k√Ω t·ª± ƒë·∫∑c bi·ªát trong URL (d√πng % + hex). B·∫£o to√†n /, ?, =, &.',
    code: (mode) => mode === 'encode' ?
`<span class="im">from</span> urllib.parse <span class="im">import</span> quote, urlencode

text = <span class="st">"Xin ch√†o & Vi·ªát Nam = ƒë·∫πp!"</span>
encoded = quote(text)
<span class="fn">print</span>(encoded)

<span class="cm"># Encode dict th√†nh query string</span>
params = {<span class="st">'name'</span>: <span class="st">'Vi·ªát Nam'</span>, <span class="st">'type'</span>: <span class="st">'ƒë·∫∑c bi·ªát'</span>}
query = urlencode(params)
<span class="fn">print</span>(query)` :
`<span class="im">from</span> urllib.parse <span class="im">import</span> unquote

encoded = <span class="st">"Xin%20ch%C3%A0o%20%26%20Vi%E1%BB%87t%20Nam"</span>
decoded = unquote(encoded)
<span class="fn">print</span>(decoded)`,
    sample: { encode: 'Xin ch√†o & Vi·ªát Nam = 100%!', decode: 'Xin%20ch%C3%A0o%20%26%20Vi%E1%BB%87t%20Nam' }
  },
  url_full: {
    info: '<strong>URL Full Encode</strong>: M√£ h√≥a to√†n b·ªô k√Ω t·ª± k·ªÉ c·∫£ /, ?, =. D√πng ƒë·ªÉ encode gi√° tr·ªã (kh√¥ng ph·∫£i to√†n b·ªô URL).',
    code: (mode) => mode === 'encode' ?
`<span class="im">from</span> urllib.parse <span class="im">import</span> quote_plus

text = <span class="st">"Hello World & more=stuff"</span>
encoded = quote_plus(text)
<span class="fn">print</span>(encoded)  <span class="cm"># Hello+World+%26+more%3Dstuff</span>` :
`<span class="im">from</span> urllib.parse <span class="im">import</span> unquote_plus

encoded = <span class="st">"Hello+World+%26+more%3Dstuff"</span>
decoded = unquote_plus(encoded)
<span class="fn">print</span>(decoded)`,
    sample: { encode: 'Hello World & more=stuff', decode: 'Hello+World+%26+more%3Dstuff' }
  },
  punycode: {
    info: '<strong>Punycode</strong>: M√£ h√≥a t√™n mi·ªÅn qu·ªëc t·∫ø h√≥a (IDN) sang ASCII. D√πng cho t√™n mi·ªÅn ti·∫øng Vi·ªát.',
    code: (mode) => mode === 'encode' ?
`<span class="cm"># Encode domain ti·∫øng Vi·ªát sang punycode</span>
domain = <span class="st">"vi·ªát.vn"</span>
encoded = domain.encode(<span class="st">'idna'</span>).decode(<span class="st">'ascii'</span>)
<span class="fn">print</span>(encoded)  <span class="cm"># xn--vit-mla.vn</span>

<span class="cm"># Encode t·ª´ng nh√£n</span>
label = <span class="st">"vi·ªát"</span>
result = label.encode(<span class="st">'punycode'</span>).decode(<span class="st">'ascii'</span>)
<span class="fn">print</span>(<span class="st">f"xn--{result}"</span>)` :
`<span class="cm"># Decode punycode v·ªÅ Unicode</span>
encoded = <span class="st">"xn--vit-mla"</span>
decoded = encoded[<span class="num">4</span>:].encode(<span class="st">'ascii'</span>).decode(<span class="st">'punycode'</span>)
<span class="fn">print</span>(decoded)  <span class="cm"># vi·ªát</span>`,
    sample: { encode: 'vi·ªát', decode: 'xn--vit-mla' }
  },
  binary: {
    info: '<strong>Binary</strong>: Bi·ªÉu di·ªÖn vƒÉn b·∫£n d∆∞·ªõi d·∫°ng s·ªë nh·ªã ph√¢n (0 v√† 1). M·ªói k√Ω t·ª± = 8 bit.',
    code: (mode) => mode === 'encode' ?
`text = <span class="st">"Hi"</span>
<span class="cm"># Chuy·ªÉn th√†nh binary</span>
binary = <span class="st">" "</span>.join(<span class="fn">format</span>(<span class="fn">ord</span>(c), <span class="st">'08b'</span>) <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(binary)  <span class="cm"># 01001000 01101001</span>

<span class="cm"># M·ªôt c√°ch kh√°c</span>
result = <span class="st">" "</span>.join(<span class="fn">bin</span>(<span class="fn">ord</span>(c))[<span class="num">2</span>:].zfill(<span class="num">8</span>) <span class="kw">for</span> c <span class="kw">in</span> text)` :
`<span class="cm"># Gi·∫£i m√£ binary</span>
binary = <span class="st">"01001000 01101001"</span>
bits = binary.split()
text = <span class="st">""</span>.join(<span class="fn">chr</span>(<span class="fn">int</span>(b, <span class="num">2</span>)) <span class="kw">for</span> b <span class="kw">in</span> bits)
<span class="fn">print</span>(text)  <span class="cm"># Hi</span>`,
    sample: { encode: 'Hi', decode: '01001000 01101001' }
  },
  octal: {
    info: '<strong>Octal</strong>: H·ªá c∆° s·ªë 8. D√πng trong quy·ªÅn file Unix (chmod 755), ƒë√¥i khi trong C/Python.',
    code: (mode) => mode === 'encode' ?
`text = <span class="st">"Hi"</span>
<span class="cm"># Chuy·ªÉn th√†nh octal</span>
octal = <span class="st">" "</span>.join(<span class="fn">format</span>(<span class="fn">ord</span>(c), <span class="st">'o'</span>) <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(octal)  <span class="cm"># 110 151</span>

<span class="cm"># V·ªõi prefix 0o</span>
result = <span class="st">" "</span>.join(<span class="fn">oct</span>(<span class="fn">ord</span>(c)) <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(result)  <span class="cm"># 0o110 0o151</span>` :
`octal_str = <span class="st">"110 151"</span>
text = <span class="st">""</span>.join(<span class="fn">chr</span>(<span class="fn">int</span>(o, <span class="num">8</span>)) <span class="kw">for</span> o <span class="kw">in</span> octal_str.split())
<span class="fn">print</span>(text)  <span class="cm"># Hi</span>`,
    sample: { encode: 'Hi', decode: '110 151' }
  },
  hex_str: {
    info: '<strong>Hex String</strong>: Bi·ªÉu di·ªÖn vƒÉn b·∫£n d∆∞·ªõi d·∫°ng hex li√™n t·ª•c ho·∫∑c c√°ch nhau. Ph·ªï bi·∫øn trong debug, crypto.',
    code: (mode) => mode === 'encode' ?
`text = <span class="st">"Hello"</span>
<span class="cm"># C√°ch 1: bytes.hex()</span>
result = text.encode(<span class="st">'utf-8'</span>).hex()
<span class="fn">print</span>(result)  <span class="cm"># 48656c6c6f</span>

<span class="cm"># C√°ch 2: v·ªõi d·∫•u c√°ch</span>
result2 = <span class="st">" "</span>.join(<span class="fn">format</span>(<span class="fn">ord</span>(c), <span class="st">'02x'</span>) <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(result2)  <span class="cm"># 48 65 6c 6c 6f</span>` :
`hex_str = <span class="st">"48656c6c6f"</span>
text = bytes.fromhex(hex_str).decode(<span class="st">'utf-8'</span>)
<span class="fn">print</span>(text)  <span class="cm"># Hello</span>`,
    sample: { encode: 'Hello', decode: '48656c6c6f' }
  },
  xxencode: {
    info: '<strong>XX Encode</strong>: T∆∞∆°ng t·ª± UUencode nh∆∞ng d√πng k√Ω t·ª± an to√†n h∆°n. √çt ph·ªï bi·∫øn, ch·ªß y·∫øu d√πng tr√™n Usenet.',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> uu, io

<span class="cm"># Python kh√¥ng c√≥ xxencode tr·ª±c ti·∫øp</span>
<span class="cm"># D√πng uu encode (t∆∞∆°ng t·ª±)</span>
data = <span class="st">b"Hello, World!"</span>
output = io.BytesIO()
uu.encode(io.BytesIO(data), output, <span class="st">'file.txt'</span>)
<span class="fn">print</span>(output.getvalue().decode())` :
`<span class="im">import</span> uu, io

<span class="cm"># UU decode</span>
uu_data = <span class="st">b"begin 666 file.txt\\n-2&5L;&\\ ( &!O&UL9 \\n \\nend\\n"</span>
inp = io.BytesIO(uu_data)
out = io.BytesIO()
uu.decode(inp, out)
<span class="fn">print</span>(out.getvalue())`,
    sample: { encode: 'Hello', decode: 'SGVsbG8=' }
  },
  morse: {
    info: '<strong>Morse Code</strong>: M√£ Morse d√πng ch·∫•m (.) v√† g·∫°ch (-) ƒë·ªÉ bi·ªÉu di·ªÖn ch·ªØ c√°i. L·ªãch s·ª≠ vi·ªÖn th√¥ng.',
    code: (mode) => mode === 'encode' ?
`MORSE = {
    <span class="st">'A'</span>: <span class="st">'.-'</span>, <span class="st">'B'</span>: <span class="st">'-...'</span>, <span class="st">'C'</span>: <span class="st">'-.-.'</span>, <span class="st">'D'</span>: <span class="st">'-.. '</span>,
    <span class="st">'E'</span>: <span class="st">'.'</span>, <span class="st">'F'</span>: <span class="st">'..-.'</span>, <span class="st">'G'</span>: <span class="st">'--.'</span>, <span class="st">'H'</span>: <span class="st">'....'</span>,
    <span class="st">'I'</span>: <span class="st">'..'</span>, <span class="st">'J'</span>: <span class="st">'.---'</span>, <span class="st">'K'</span>: <span class="st">'-.-'</span>, <span class="st">'L'</span>: <span class="st">'.-..'</span>,
    <span class="st">' '</span>: <span class="st">'/'</span>
}

text = <span class="st">"HI"</span>
morse = <span class="st">" "</span>.join(MORSE.get(c.upper(), <span class="st">'?'</span>) <span class="kw">for</span> c <span class="kw">in</span> text)
<span class="fn">print</span>(morse)  <span class="cm"># .... ..</span>` :
`MORSE_INV = {v: k <span class="kw">for</span> k, v <span class="kw">in</span> MORSE.items()}

morse = <span class="st">".... .."</span>
text = <span class="st">""</span>.join(MORSE_INV.get(c, <span class="st">'?'</span>) <span class="kw">for</span> c <span class="kw">in</span> morse.split())
<span class="fn">print</span>(text)  <span class="cm"># HI</span>`,
    sample: { encode: 'HELLO', decode: '.... . .-.. .-.. ---' }
  },
  caesar: {
    info: '<strong>Caesar Cipher</strong>: D·ªãch chuy·ªÉn m·ªói ch·ªØ c√°i N v·ªã tr√≠. M·∫≠t m√£ c·ªï ƒëi·ªÉn ƒë∆∞·ª£c Julius Caesar d√πng.',
    code: (mode) => mode === 'encode' ?
`<span class="kw">def</span> <span class="fn">caesar</span>(text, shift=<span class="num">13</span>):
    result = []
    <span class="kw">for</span> char <span class="kw">in</span> text:
        <span class="kw">if</span> char.isalpha():
            base = <span class="fn">ord</span>(<span class="st">'A'</span>) <span class="kw">if</span> char.isupper() <span class="kw">else</span> <span class="fn">ord</span>(<span class="st">'a'</span>)
            shifted = (<span class="fn">ord</span>(char) - base + shift) % <span class="num">26</span> + base
            result.append(<span class="fn">chr</span>(shifted))
        <span class="kw">else</span>:
            result.append(char)
    <span class="kw">return</span> <span class="st">""</span>.join(result)

<span class="fn">print</span>(<span class="fn">caesar</span>(<span class="st">"Hello, World!"</span>, shift=<span class="num">3</span>))
<span class="cm"># Khboor, Zruog!</span>` :
`<span class="cm"># Gi·∫£i m√£: d√πng shift √¢m ho·∫∑c 26-shift</span>
<span class="kw">def</span> <span class="fn">caesar_decode</span>(text, shift=<span class="num">3</span>):
    <span class="kw">return</span> <span class="fn">caesar</span>(text, -shift)

<span class="fn">print</span>(<span class="fn">caesar_decode</span>(<span class="st">"Khboor, Zruog!"</span>, <span class="num">3</span>))
<span class="cm"># Hello, World!</span>`,
    sample: { encode: 'Hello, World!', decode: 'Khoor, Zruog!' }
  },
  vigenere: {
    info: '<strong>Vigen√®re Cipher</strong>: D√πng t·ª´ kh√≥a ƒë·ªÉ m√£ h√≥a. M·∫°nh h∆°n Caesar v√¨ m·ªói k√Ω t·ª± c√≥ shift kh√°c nhau.',
    code: (mode) => mode === 'encode' ?
`<span class="kw">def</span> <span class="fn">vigenere</span>(text, key, encrypt=<span class="kw">True</span>):
    result, k_idx = [], <span class="num">0</span>
    <span class="kw">for</span> char <span class="kw">in</span> text:
        <span class="kw">if</span> char.isalpha():
            shift = <span class="fn">ord</span>(key[k_idx % <span class="fn">len</span>(key)].upper()) - <span class="fn">ord</span>(<span class="st">'A'</span>)
            base = <span class="fn">ord</span>(<span class="st">'A'</span>) <span class="kw">if</span> char.isupper() <span class="kw">else</span> <span class="fn">ord</span>(<span class="st">'a'</span>)
            offset = shift <span class="kw">if</span> encrypt <span class="kw">else</span> -shift
            result.append(<span class="fn">chr</span>((<span class="fn">ord</span>(char) - base + offset) % <span class="num">26</span> + base))
            k_idx += <span class="num">1</span>
        <span class="kw">else</span>:
            result.append(char)
    <span class="kw">return</span> <span class="st">""</span>.join(result)

<span class="fn">print</span>(<span class="fn">vigenere</span>(<span class="st">"Hello"</span>, <span class="st">"KEY"</span>))` :
`<span class="fn">print</span>(<span class="fn">vigenere</span>(<span class="st">"Rijvs"</span>, <span class="st">"KEY"</span>, encrypt=<span class="kw">False</span>))
<span class="cm"># Hello</span>`,
    sample: { encode: 'Hello World', decode: 'Rijvs Uyvjn' }
  },
  atbash: {
    info: '<strong>Atbash</strong>: ƒê·∫£o ng∆∞·ª£c b·∫£ng ch·ªØ c√°i (A‚ÜîZ, B‚ÜîY...). M·∫≠t m√£ Hebrew c·ªï ƒë·∫°i, ƒë·ªëi x·ª©ng.',
    code: () =>
`<span class="kw">def</span> <span class="fn">atbash</span>(text):
    result = []
    <span class="kw">for</span> char <span class="kw">in</span> text:
        <span class="kw">if</span> char.isalpha():
            base = <span class="fn">ord</span>(<span class="st">'A'</span>) <span class="kw">if</span> char.isupper() <span class="kw">else</span> <span class="fn">ord</span>(<span class="st">'a'</span>)
            mirrored = base + (<span class="num">25</span> - (<span class="fn">ord</span>(char) - base))
            result.append(<span class="fn">chr</span>(mirrored))
        <span class="kw">else</span>:
            result.append(char)
    <span class="kw">return</span> <span class="st">""</span>.join(result)

<span class="cm"># Atbash ƒë·ªëi x·ª©ng: encode = decode</span>
<span class="fn">print</span>(<span class="fn">atbash</span>(<span class="st">"Hello"</span>))   <span class="cm"># Svool</span>
<span class="fn">print</span>(<span class="fn">atbash</span>(<span class="st">"Svool"</span>))   <span class="cm"># Hello</span>`,
    sample: { encode: 'Hello World', decode: 'Svool Dliow' }
  },
  xor: {
    info: '<strong>XOR Cipher</strong>: M√£ h√≥a b·∫±ng to√°n t·ª≠ XOR v·ªõi m·ªôt key. ƒê∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ khi key ƒë·ªß d√†i.',
    code: (mode) => mode === 'encode' ?
`<span class="kw">def</span> <span class="fn">xor_cipher</span>(text, key):
    key_bytes = key.encode()
    result = bytes(
        b ^ key_bytes[i % <span class="fn">len</span>(key_bytes)]
        <span class="kw">for</span> i, b <span class="kw">in</span> <span class="fn">enumerate</span>(text.encode())
    )
    <span class="cm"># Tr·∫£ v·ªÅ hex ƒë·ªÉ d·ªÖ ƒë·ªçc</span>
    <span class="kw">return</span> result.hex()

text = <span class="st">"Hello"</span>
key = <span class="st">"secret"</span>
<span class="fn">print</span>(<span class="fn">xor_cipher</span>(text, key))` :
`<span class="kw">def</span> <span class="fn">xor_decode</span>(hex_str, key):
    data = bytes.fromhex(hex_str)
    key_bytes = key.encode()
    result = bytes(
        b ^ key_bytes[i % <span class="fn">len</span>(key_bytes)]
        <span class="kw">for</span> i, b <span class="kw">in</span> <span class="fn">enumerate</span>(data)
    )
    <span class="kw">return</span> result.decode()

<span class="fn">print</span>(<span class="fn">xor_decode</span>(<span class="st">"3a000b1e0f"</span>, <span class="st">"secret"</span>))`,
    sample: { encode: 'Hello', decode: '3a000b1e0f' }
  },
  json_format: {
    info: '<strong>JSON Format</strong>: ƒê·ªãnh d·∫°ng JSON th√†nh d·∫°ng d·ªÖ ƒë·ªçc v·ªõi th·ª•t l·ªÅ. H·ªØu √≠ch ƒë·ªÉ debug API responses.',
    code: () =>
`<span class="im">import</span> json

<span class="cm"># Minified JSON</span>
raw = <span class="st">'{"name":"Alice","age":30,"city":"Hanoi"}'</span>

<span class="cm"># Prettify v·ªõi indent</span>
obj = json.loads(raw)
pretty = json.dumps(obj, indent=<span class="num">4</span>, ensure_ascii=<span class="kw">False</span>)
<span class="fn">print</span>(pretty)

<span class="cm"># Sort keys</span>
sorted_json = json.dumps(obj, indent=<span class="num">4</span>, sort_keys=<span class="kw">True</span>, ensure_ascii=<span class="kw">False</span>)`,
    sample: { encode: '{"name":"Alice","age":30,"hobbies":["code","coffee"]}', decode: '{\n    "name": "Alice",\n    "age": 30\n}' }
  },
  json_min: {
    info: '<strong>JSON Minify</strong>: N√©n JSON b·∫±ng c√°ch lo·∫°i b·ªè kho·∫£ng tr·∫Øng. Gi·∫£m k√≠ch th∆∞·ªõc data truy·ªÅn t·∫£i.',
    code: () =>
`<span class="im">import</span> json

<span class="cm"># JSON ƒë∆∞·ª£c format</span>
formatted = <span class="st">"""
{
    "name": "Alice",
    "age": 30,
    "city": "H√† N·ªôi"
}"""</span>

<span class="cm"># Minify</span>
obj = json.loads(formatted)
minified = json.dumps(obj, separators=(<span class="st">','</span>, <span class="st">':'</span>), ensure_ascii=<span class="kw">False</span>)
<span class="fn">print</span>(minified)`,
    sample: { encode: '{\n  "name": "Alice",\n  "age": 30\n}', decode: '{"name":"Alice","age":30}' }
  },
  zlib_b64: {
    info: '<strong>zlib + Base64</strong>: N√©n d·ªØ li·ªáu b·∫±ng zlib r·ªìi encode Base64. H·ªØu √≠ch cho chu·ªói d√†i l·∫∑p l·∫°i.',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> zlib, base64

text = <span class="st">"Hello World " * 100</span>
compressed = zlib.compress(text.encode(<span class="st">'utf-8'</span>))
result = base64.b64encode(compressed).decode()
<span class="fn">print</span>(<span class="st">f"G·ªëc: {len(text)} ‚Üí N√©n: {len(result)}"</span>)
<span class="fn">print</span>(result)` :
`<span class="im">import</span> zlib, base64

encoded = <span class="st">"eJzLSM3JyQcABiwCFQ=="</span>
compressed = base64.b64decode(encoded)
text = zlib.decompress(compressed).decode(<span class="st">'utf-8'</span>)
<span class="fn">print</span>(text)`,
    sample: { encode: 'Hello World Hello World Hello World', decode: 'eJzLSM3JyU/OLi0uBgAQBgN3' }
  },
  gzip_b64: {
    info: '<strong>gzip + Base64</strong>: T∆∞∆°ng t·ª± zlib nh∆∞ng v·ªõi gzip. Ph·ªï bi·∫øn h∆°n trong web (Content-Encoding: gzip).',
    code: (mode) => mode === 'encode' ?
`<span class="im">import</span> gzip, base64

text = <span class="st">"Hello World"</span>
compressed = gzip.compress(text.encode(<span class="st">'utf-8'</span>))
result = base64.b64encode(compressed).decode()
<span class="fn">print</span>(result)` :
`<span class="im">import</span> gzip, base64

encoded = <span class="st">"H4sI..."</span>
compressed = base64.b64decode(encoded)
text = gzip.decompress(compressed).decode(<span class="st">'utf-8'</span>)
<span class="fn">print</span>(text)`,
    sample: { encode: 'Hello World', decode: 'H4sIAAAAAAAAA8tILUpVslIqLU4tykvMTQUA7LBl+QwAAAA=' }
  }
};

// Morse code table
const MORSE_TABLE = {
  'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.',
  'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..',
  'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.',
  'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
  'Y': '-.--', 'Z': '--..', '0': '-----', '1': '.----', '2': '..---',
  '3': '...--', '4': '....-', '5': '.....', '6': '-....', '7': '--...',
  '8': '---..', '9': '----.', ' ': '/', '.': '.-.-.-', ',': '--..--',
  '?': '..--..', '!': '-.-.--', '-': '-....-', '/': '-..-.',
};
const MORSE_INV = Object.fromEntries(Object.entries(MORSE_TABLE).map(([k,v]) => [v,k]));

let currentCategory = 'text';
let currentMethod = 'base64';
let currentMode = 'encode';
let caesarShift = 3;
let vigenereKey = 'KEY';
let xorKey = 'secret';

function switchCategory(cat) {
  currentCategory = cat;
  document.querySelectorAll('.tab-btn').forEach((b,i) => {
    b.classList.toggle('active', Object.keys(categories)[i] === cat);
  });
  renderMethods();
  const firstMethod = categories[cat].methods[0].id;
  selectMethod(firstMethod);
}

function renderMethods() {
  const grid = document.getElementById('methodGrid');
  const cat = categories[currentCategory];
  grid.innerHTML = cat.methods.map(m => `
    <div class="method-card${m.id === currentMethod ? ' active' : ''}" onclick="selectMethod('${m.id}')">
      <div class="dot" style="background:${m.dot}"></div>
      ${m.name}
    </div>
  `).join('');
}

function selectMethod(id) {
  currentMethod = id;
  document.querySelectorAll('.method-card').forEach(c => {
    c.classList.toggle('active', c.textContent.trim().includes(
      categories[currentCategory].methods.find(m=>m.id===id)?.name || ''));
  });
  // re-render to fix active state properly
  renderMethods();
  updateUI();
  buildExtraOpts();
}

function updateUI() {
  const info = methodInfo[currentMethod];
  if (!info) return;
  document.getElementById('currentMethodName').textContent = 
    categories[currentCategory].methods.find(m=>m.id===currentMethod)?.name || currentMethod;
  document.getElementById('infoBar').innerHTML = info.info;
  document.getElementById('codeBody').innerHTML = info.code(currentMode);
  
  const isHashOnly = ['md5','sha1','sha256','sha512','sha3_256'].includes(currentMethod);
  if (isHashOnly) {
    document.getElementById('encBtn').classList.add('active');
    document.getElementById('decBtn').classList.remove('active');
    document.getElementById('decBtn').style.opacity = '0.3';
    document.getElementById('decBtn').style.pointerEvents = 'none';
    currentMode = 'encode';
  } else {
    document.getElementById('decBtn').style.opacity = '1';
    document.getElementById('decBtn').style.pointerEvents = 'auto';
  }
  
  const modeLabel = currentMode.toUpperCase();
  document.getElementById('panelTag').textContent = modeLabel;
}

function buildExtraOpts() {
  const container = document.getElementById('extraOpts');
  if (currentMethod === 'caesar') {
    container.innerHTML = `
      <span class="opt-label">Shift:</span>
      <select class="opt-select" onchange="caesarShift=parseInt(this.value)">
        ${Array.from({length:25},(_,i)=>`<option value="${i+1}"${i+1===caesarShift?' selected':''}>${i+1}</option>`).join('')}
      </select>`;
  } else if (currentMethod === 'vigenere') {
    container.innerHTML = `
      <span class="opt-label">Key:</span>
      <input type="text" value="${vigenereKey}" oninput="vigenereKey=this.value.toUpperCase()"
        style="background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);
               font-family:'JetBrains Mono',monospace;font-size:11px;padding:5px 10px;width:120px;outline:none">`;
  } else if (currentMethod === 'xor') {
    container.innerHTML = `
      <span class="opt-label">XOR Key:</span>
      <input type="text" value="${xorKey}" oninput="xorKey=this.value"
        style="background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);
               font-family:'JetBrains Mono',monospace;font-size:11px;padding:5px 10px;width:120px;outline:none">`;
  } else {
    container.innerHTML = '';
  }
}

function setMode(mode) {
  currentMode = mode;
  document.getElementById('encBtn').classList.toggle('active', mode === 'encode');
  document.getElementById('decBtn').classList.toggle('active', mode === 'decode');
  updateUI();
}

function execute() {
  const input = document.getElementById('inputText').value;
  if (!input.trim()) { showOutput('', 'placeholder'); return; }
  
  let result;
  try { result = processMethod(currentMethod, input, currentMode); }
  catch(e) { showOutput('‚ö† L·ªói: ' + e.message, 'error'); return; }
  
  showOutput(result, 'success');
  document.getElementById('statIn').textContent = input.length;
  document.getElementById('statOut').textContent = result.length;
  const ratio = input.length > 0 ? (result.length / input.length).toFixed(2) + 'x' : '-';
  document.getElementById('statRatio').textContent = ratio;
  document.getElementById('statMethod').textContent = 
    categories[currentCategory].methods.find(m=>m.id===currentMethod)?.name || currentMethod;
}

function showOutput(text, type) {
  const el = document.getElementById('outputArea');
  el.className = 'output-area' + (type === 'error' ? ' error' : type === 'success' ? ' success' : '');
  el.textContent = type === 'placeholder' ? '' : text;
  if (type === 'placeholder') {
    el.innerHTML = '<span class="output-placeholder">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</span>';
  }
}

function processMethod(method, input, mode) {
  switch(method) {
    case 'base64':
      if (mode === 'encode') return btoa(unescape(encodeURIComponent(input)));
      else return decodeURIComponent(escape(atob(input.trim())));

    case 'base32':
      if (mode === 'encode') return base32Encode(new TextEncoder().encode(input));
      else return new TextDecoder().decode(base32Decode(input.trim().toUpperCase()));

    case 'base16':
      if (mode === 'encode') return Array.from(new TextEncoder().encode(input)).map(b=>b.toString(16).padStart(2,'0').toUpperCase()).join('');
      else return new TextDecoder().decode(new Uint8Array(input.match(/../g).map(h=>parseInt(h,16))));

    case 'base85':
      if (mode === 'encode') return btoa(unescape(encodeURIComponent(input))) + ' [Base85 needs Python; showing Base64]';
      else return decodeURIComponent(escape(atob(input.trim().replace(' [Base85 needs Python; showing Base64]',''))));

    case 'rot13':
      return input.replace(/[a-zA-Z]/g, c => {
        const base = c <= 'Z' ? 65 : 97;
        return String.fromCharCode((c.charCodeAt(0) - base + 13) % 26 + base);
      });

    case 'unicode':
      if (mode === 'encode') return Array.from(input).map(c => {
        const code = c.codePointAt(0);
        return code > 127 ? `\\u${code.toString(16).padStart(4,'0')}` : c;
      }).join('');
      else return input.replace(/\\u([0-9a-fA-F]{4})/g, (_,h) => String.fromCharCode(parseInt(h,16)));

    case 'html':
      if (mode === 'encode') {
        return input.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
          .replace(/"/g,'&quot;').replace(/'/g,'&#39;');
      } else {
        return input.replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>')
          .replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#(\d+);/g,(_,n)=>String.fromCharCode(n));
      }

    case 'ascii':
      if (mode === 'encode') return Array.from(input).map(c => c.charCodeAt(0)).join(' ');
      else return input.split(/\s+/).map(n => String.fromCharCode(parseInt(n))).join('');

    case 'md5': return 'MD5: ' + md5(input);
    case 'sha1': return 'SHA-1: [Requires SubtleCrypto / Python]\n–ü—Ä–æ–±–Ω–∏–π: ' + sha1Simple(input);
    case 'sha256': return sha256Browser(input).then ? '[Async SHA-256 - press again]' : sha256Simple(input);
    case 'sha512': return 'SHA-512: [Requires Python hashlib]\nmd5: ' + md5(input);
    case 'sha3_256': return 'SHA3-256: [Requires Python hashlib]\nFallback SHA-256: ' + sha256Simple(input);

    case 'url':
      if (mode === 'encode') return encodeURI(input);
      else return decodeURI(input);

    case 'url_full':
      if (mode === 'encode') return encodeURIComponent(input);
      else return decodeURIComponent(input);

    case 'punycode':
      if (mode === 'encode') {
        return input.split('').map(c => c.charCodeAt(0) > 127 ? `\\u${c.charCodeAt(0).toString(16)}` : c).join('') + ' [Punycode needs Python idna]';
      }
      return input.replace(/\\u([0-9a-f]{4})/gi, (_,h) => String.fromCharCode(parseInt(h,16)));

    case 'binary':
      if (mode === 'encode') return Array.from(new TextEncoder().encode(input)).map(b=>b.toString(2).padStart(8,'0')).join(' ');
      else return new TextDecoder().decode(new Uint8Array(input.trim().split(/\s+/).map(b=>parseInt(b,2))));

    case 'octal':
      if (mode === 'encode') return Array.from(new TextEncoder().encode(input)).map(b=>b.toString(8)).join(' ');
      else return new TextDecoder().decode(new Uint8Array(input.trim().split(/\s+/).map(b=>parseInt(b,8))));

    case 'hex_str':
      if (mode === 'encode') return Array.from(new TextEncoder().encode(input)).map(b=>b.toString(16).padStart(2,'0')).join('');
      else return new TextDecoder().decode(new Uint8Array(input.match(/../g)?.map(h=>parseInt(h,16))||[]));

    case 'morse':
      if (mode === 'encode') return Array.from(input.toUpperCase()).map(c => MORSE_TABLE[c] || '?').join(' ');
      else return input.split(/\s+/).map(c => MORSE_INV[c] || '?').join('').replace(/\?/g,' ').trim();

    case 'xxencode': return mode === 'encode' ? btoa(unescape(encodeURIComponent(input))) + ' [XX‚âàBase64 in browser]' : decodeURIComponent(escape(atob(input.replace(' [XX‚âàBase64 in browser]',''))));

    case 'caesar':
      return input.replace(/[a-zA-Z]/g, c => {
        const base = c <= 'Z' ? 65 : 97;
        const shift = mode === 'encode' ? caesarShift : 26 - caesarShift;
        return String.fromCharCode((c.charCodeAt(0) - base + shift) % 26 + base);
      });

    case 'vigenere': {
      const key = (vigenereKey || 'KEY').toUpperCase().replace(/[^A-Z]/g,'') || 'KEY';
      let ki = 0;
      return Array.from(input).map(c => {
        if (/[a-zA-Z]/.test(c)) {
          const base = c <= 'Z' ? 65 : 97;
          const shift = key.charCodeAt(ki++ % key.length) - 65;
          const offset = mode === 'encode' ? shift : 26 - shift;
          return String.fromCharCode((c.charCodeAt(0) - base + offset) % 26 + base);
        }
        return c;
      }).join('');
    }

    case 'atbash':
      return Array.from(input).map(c => {
        if (/[a-zA-Z]/.test(c)) {
          const base = c <= 'Z' ? 65 : 97;
          return String.fromCharCode(base + 25 - (c.charCodeAt(0) - base));
        }
        return c;
      }).join('');

    case 'xor': {
      const key = xorKey || 'secret';
      const bytes = new TextEncoder().encode(input);
      const keyBytes = new TextEncoder().encode(key);
      const out = new Uint8Array(bytes.length);
      if (mode === 'encode') {
        for(let i=0;i<bytes.length;i++) out[i] = bytes[i] ^ keyBytes[i % keyBytes.length];
        return Array.from(out).map(b=>b.toString(16).padStart(2,'0')).join('');
      } else {
        const hexBytes = input.match(/../g)?.map(h=>parseInt(h,16)) || [];
        const xorBytes = new Uint8Array(hexBytes);
        const res = new Uint8Array(xorBytes.length);
        for(let i=0;i<xorBytes.length;i++) res[i] = xorBytes[i] ^ keyBytes[i % keyBytes.length];
        return new TextDecoder().decode(res);
      }
    }

    case 'json_format': {
      const obj = JSON.parse(input);
      return JSON.stringify(obj, null, 4);
    }

    case 'json_min': {
      const obj = JSON.parse(input);
      return JSON.stringify(obj);
    }

    case 'zlib_b64': return mode === 'encode' ? btoa(unescape(encodeURIComponent(input))) + ' [zlib needs Python in browser]' : decodeURIComponent(escape(atob(input.replace(' [zlib needs Python in browser]',''))));

    case 'gzip_b64': return mode === 'encode' ? btoa(unescape(encodeURIComponent(input))) + ' [gzip needs Python in browser]' : decodeURIComponent(escape(atob(input.replace(' [gzip needs Python in browser]',''))));

    default: return input;
  }
}

// Simple hash implementations
function md5(str) {
  function safeAdd(x,y){const lsw=(x&0xffff)+(y&0xffff);return((x>>16)+(y>>16)+(lsw>>16))<<16|lsw&0xffff}
  function bitRotateLeft(num,cnt){return num<<cnt|num>>>32-cnt}
  function md5cmn(q,a,b,x,s,t){return safeAdd(bitRotateLeft(safeAdd(safeAdd(a,q),safeAdd(x,t)),s),b)}
  function md5ff(a,b,c,d,x,s,t){return md5cmn(b&c|~b&d,a,b,x,s,t)}
  function md5gg(a,b,c,d,x,s,t){return md5cmn(b&d|c&~d,a,b,x,s,t)}
  function md5hh(a,b,c,d,x,s,t){return md5cmn(b^c^d,a,b,x,s,t)}
  function md5ii(a,b,c,d,x,s,t){return md5cmn(c^(b|~d),a,b,x,s,t)}
  
  const utf8 = unescape(encodeURIComponent(str));
  const bs = new Uint8Array(utf8.length);
  for(let i=0;i<utf8.length;i++) bs[i] = utf8.charCodeAt(i);
  
  const words = [];
  for(let i=0;i<bs.length*8;i+=8) words[i>>5] |= (bs[i/8]&0xff)<<(i%32);
  const l = bs.length*8;
  words[l>>5] |= 0x80<<(l%32);
  words[(((l+64)>>>9)<<4)+14] = l;
  
  let a=1732584193, b=-271733879, c=-1732584194, d=271733878;
  for(let i=0;i<words.length;i+=16){
    const [pa,pb,pc,pd]=[a,b,c,d];
    a=md5ff(a,b,c,d,words[i],7,-680876936); d=md5ff(d,a,b,c,words[i+1],12,-389564586);
    c=md5ff(c,d,a,b,words[i+2],17,606105819); b=md5ff(b,c,d,a,words[i+3],22,-1044525330);
    a=md5ff(a,b,c,d,words[i+4],7,-176418897); d=md5ff(d,a,b,c,words[i+5],12,1200080426);
    c=md5ff(c,d,a,b,words[i+6],17,-1473231341); b=md5ff(b,c,d,a,words[i+7],22,-45705983);
    a=md5ff(a,b,c,d,words[i+8],7,1770035416); d=md5ff(d,a,b,c,words[i+9],12,-1958414417);
    c=md5ff(c,d,a,b,words[i+10],17,-42063); b=md5ff(b,c,d,a,words[i+11],22,-1990404162);
    a=md5ff(a,b,c,d,words[i+12],7,1804603682); d=md5ff(d,a,b,c,words[i+13],12,-40341101);
    c=md5ff(c,d,a,b,words[i+14],17,-1502002290); b=md5ff(b,c,d,a,words[i+15],22,1236535329);
    a=md5gg(a,b,c,d,words[i+1],5,-165796510); d=md5gg(d,a,b,c,words[i+6],9,-1069501632);
    c=md5gg(c,d,a,b,words[i+11],14,643717713); b=md5gg(b,c,d,a,words[i],20,-373897302);
    a=md5gg(a,b,c,d,words[i+5],5,-701558691); d=md5gg(d,a,b,c,words[i+10],9,38016083);
    c=md5gg(c,d,a,b,words[i+15],14,-660478335); b=md5gg(b,c,d,a,words[i+4],20,-405537848);
    a=md5gg(a,b,c,d,words[i+9],5,568446438); d=md5gg(d,a,b,c,words[i+14],9,-1019803690);
    c=md5gg(c,d,a,b,words[i+3],14,-187363961); b=md5gg(b,c,d,a,words[i+8],20,1163531501);
    a=md5gg(a,b,c,d,words[i+13],5,-1444681467); d=md5gg(d,a,b,c,words[i+2],9,-51403784);
    c=md5gg(c,d,a,b,words[i+7],14,1735328473); b=md5gg(b,c,d,a,words[i+12],20,-1926607734);
    a=md5hh(a,b,c,d,words[i+5],4,-378558); d=md5hh(d,a,b,c,words[i+8],11,-2022574463);
    c=md5hh(c,d,a,b,words[i+11],16,1839030562); b=md5hh(b,c,d,a,words[i+14],23,-35309556);
    a=md5hh(a,b,c,d,words[i+1],4,-1530992060); d=md5hh(d,a,b,c,words[i+4],11,1272893353);
    c=md5hh(c,d,a,b,words[i+7],16,-155497632); b=md5hh(b,c,d,a,words[i+10],23,-1094730640);
    a=md5hh(a,b,c,d,words[i+13],4,681279174); d=md5hh(d,a,b,c,words[i],11,-358537222);
    c=md5hh(c,d,a,b,words[i+3],16,-722521979); b=md5hh(b,c,d,a,words[i+6],23,76029189);
    a=md5hh(a,b,c,d,words[i+9],4,-640364487); d=md5hh(d,a,b,c,words[i+12],11,-421815835);
    c=md5hh(c,d,a,b,words[i+15],16,530742520); b=md5hh(b,c,d,a,words[i+2],23,-995338651);
    a=md5ii(a,b,c,d,words[i],6,-198630844); d=md5ii(d,a,b,c,words[i+7],10,1126891415);
    c=md5ii(c,d,a,b,words[i+14],15,-1416354905); b=md5ii(b,c,d,a,words[i+5],21,-57434055);
    a=md5ii(a,b,c,d,words[i+12],6,1700485571); d=md5ii(d,a,b,c,words[i+3],10,-1894986606);
    c=md5ii(c,d,a,b,words[i+10],15,-1051523); b=md5ii(b,c,d,a,words[i+1],21,-2054922799);
    a=md5ii(a,b,c,d,words[i+8],6,1873313359); d=md5ii(d,a,b,c,words[i+15],10,-30611744);
    c=md5ii(c,d,a,b,words[i+6],15,-1560198380); b=md5ii(b,c,d,a,words[i+13],21,1309151649);
    a=md5ii(a,b,c,d,words[i+4],6,-145523070); d=md5ii(d,a,b,c,words[i+11],10,-1120210379);
    c=md5ii(c,d,a,b,words[i+2],15,718787259); b=md5ii(b,c,d,a,words[i+9],21,-343485551);
    a=safeAdd(a,pa); b=safeAdd(b,pb); c=safeAdd(c,pc); d=safeAdd(d,pd);
  }
  
  const hex = [a,b,c,d].map(n => 
    Array.from({length:4},(_,i) => ((n>>(i*8))&0xff).toString(16).padStart(2,'0')).join('')
  ).join('');
  return hex;
}

function sha256Simple(str) {
  // Simplified SHA-256 indicator
  let hash = 0;
  for(let i=0;i<str.length;i++) hash = ((hash<<5)-hash)+str.charCodeAt(i)|0;
  return '[SHA-256 needs SubtleCrypto async API]\nQuick hash: ' + Math.abs(hash).toString(16).padStart(8,'0');
}

function sha1Simple(str) {
  let hash = 0x67452301;
  for(let i=0;i<str.length;i++) hash = ((hash<<5)-hash+str.charCodeAt(i))|0;
  return hash.toString(16).padStart(8,'0') + '... [SHA-1 needs Python hashlib for full output]';
}

// Base32 implementation
const BASE32_CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
function base32Encode(bytes) {
  let bits = 0, val = 0, output = '';
  for(let i=0;i<bytes.length;i++) {
    val = (val<<8)|bytes[i]; bits += 8;
    while(bits >= 5) { output += BASE32_CHARS[(val>>>(bits-5))&31]; bits -= 5; }
  }
  if(bits > 0) output += BASE32_CHARS[(val<<(5-bits))&31];
  while(output.length%8) output += '=';
  return output;
}
function base32Decode(str) {
  str = str.replace(/=/g,'');
  const out = [];
  let bits = 0, val = 0;
  for(const c of str) {
    val = (val<<5)|BASE32_CHARS.indexOf(c); bits += 5;
    if(bits >= 8) { out.push((val>>>(bits-8))&255); bits -= 8; }
  }
  return new Uint8Array(out);
}

// Auto-detect
function autoDetect() {
  const input = document.getElementById('inputText').value.trim();
  if (!input) { alert('Nh·∫≠p d·ªØ li·ªáu v√†o √¥ Input tr∆∞·ªõc!'); return; }
  
  let detected = '';
  if (/^[A-Za-z0-9+/]+=*$/.test(input) && input.length % 4 === 0) detected = 'Base64';
  else if (/^[01 ]+$/.test(input)) detected = 'Binary';
  else if (/^[0-9a-fA-F]+$/.test(input) && input.length % 2 === 0) detected = 'Hex String';
  else if (/^[.\- /]+$/.test(input)) detected = 'Morse Code';
  else if (/(&amp;|&lt;|&gt;|&quot;|&#)/.test(input)) detected = 'HTML Entities';
  else if (/%[0-9A-F]{2}/i.test(input)) detected = 'URL Encode';
  else if (/\\u[0-9a-f]{4}/i.test(input)) detected = 'Unicode Escape';
  else if (/^[A-Z2-7]+=*$/.test(input) && input.length % 8 === 0) detected = 'Base32';
  else if (/^\{[\s\S]*\}$/.test(input) || /^\[[\s\S]*\]$/.test(input)) { try { JSON.parse(input); detected = 'JSON'; } catch(e) {} }
  
  const msg = detected ? `Ph√°t hi·ªán ƒë·ªãnh d·∫°ng: ${detected}` : 'Kh√¥ng th·ªÉ t·ª± ƒë·ªông nh·∫≠n d·∫°ng ƒë·ªãnh d·∫°ng.';
  document.getElementById('infoBar').innerHTML = `üîç <strong>${msg}</strong>`;
}

function loadSample() {
  const info = methodInfo[currentMethod];
  if (!info?.sample) return;
  const sample = info.sample[currentMode] || info.sample.encode;
  document.getElementById('inputText').value = sample;
}

function clearInput() {
  document.getElementById('inputText').value = '';
  showOutput('', 'placeholder');
}

function copyOutput() {
  const text = document.getElementById('outputArea').textContent;
  navigator.clipboard.writeText(text).then(() => {
    const btn = document.getElementById('copyBtn');
    btn.textContent = 'copied!'; btn.classList.add('copied');
    setTimeout(() => { btn.textContent = 'copy'; btn.classList.remove('copied'); }, 1500);
  });
}

function copyCode() {
  const code = document.getElementById('codeBody').textContent;
  navigator.clipboard.writeText(code);
}

function swapIO() {
  const outText = document.getElementById('outputArea').textContent;
  if (!outText || outText === 'K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...') return;
  document.getElementById('inputText').value = outText;
  showOutput('', 'placeholder');
}

// Keyboard shortcut
document.addEventListener('keydown', e => {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') { e.preventDefault(); execute(); }
});

// Live encode on input change
document.getElementById('inputText').addEventListener('input', () => execute());

// Init
renderMethods();
updateUI();
buildExtraOpts();
</script>
</body>
</html>
